{"ast":null,"code":"/**\n * Copyright (c) 2014-present, Facebook, Inc. All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule FluxContainerSubscriptions\n * \n */\n'use strict';\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError('Cannot call a class as a function');\n  }\n}\n\nvar FluxStoreGroup = require('./FluxStoreGroup');\n\nfunction shallowArrayEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  for (var i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nvar FluxContainerSubscriptions = function () {\n  function FluxContainerSubscriptions() {\n    _classCallCheck(this, FluxContainerSubscriptions);\n\n    this._callbacks = [];\n  }\n\n  FluxContainerSubscriptions.prototype.setStores = function setStores(stores) {\n    var _this = this;\n\n    if (this._stores && shallowArrayEqual(this._stores, stores)) {\n      return;\n    }\n\n    this._stores = stores;\n\n    this._resetTokens();\n\n    this._resetStoreGroup();\n\n    var changed = false;\n    var changedStores = [];\n\n    if (process.env.NODE_ENV !== 'production') {\n      // Keep track of the stores that changed for debugging purposes only\n      this._tokens = stores.map(function (store) {\n        return store.addListener(function () {\n          changed = true;\n          changedStores.push(store);\n        });\n      });\n    } else {\n      (function () {\n        var setChanged = function () {\n          changed = true;\n        };\n\n        _this._tokens = stores.map(function (store) {\n          return store.addListener(setChanged);\n        });\n      })();\n    }\n\n    var callCallbacks = function () {\n      if (changed) {\n        _this._callbacks.forEach(function (fn) {\n          return fn();\n        });\n\n        changed = false;\n\n        if (process.env.NODE_ENV !== 'production') {\n          // Uncomment this to print the stores that changed.\n          // console.log(changedStores);\n          changedStores = [];\n        }\n      }\n    };\n\n    this._storeGroup = new FluxStoreGroup(stores, callCallbacks);\n  };\n\n  FluxContainerSubscriptions.prototype.addListener = function addListener(fn) {\n    this._callbacks.push(fn);\n  };\n\n  FluxContainerSubscriptions.prototype.reset = function reset() {\n    this._resetTokens();\n\n    this._resetStoreGroup();\n\n    this._resetCallbacks();\n\n    this._resetStores();\n  };\n\n  FluxContainerSubscriptions.prototype._resetTokens = function _resetTokens() {\n    if (this._tokens) {\n      this._tokens.forEach(function (token) {\n        return token.remove();\n      });\n\n      this._tokens = null;\n    }\n  };\n\n  FluxContainerSubscriptions.prototype._resetStoreGroup = function _resetStoreGroup() {\n    if (this._storeGroup) {\n      this._storeGroup.release();\n\n      this._storeGroup = null;\n    }\n  };\n\n  FluxContainerSubscriptions.prototype._resetStores = function _resetStores() {\n    this._stores = null;\n  };\n\n  FluxContainerSubscriptions.prototype._resetCallbacks = function _resetCallbacks() {\n    this._callbacks = [];\n  };\n\n  return FluxContainerSubscriptions;\n}();\n\nmodule.exports = FluxContainerSubscriptions;","map":{"version":3,"sources":["/Users/jeffreyigims/Documents/survey/node_modules/flux/lib/FluxContainerSubscriptions.js"],"names":["_classCallCheck","instance","Constructor","TypeError","FluxStoreGroup","require","shallowArrayEqual","a","b","length","i","FluxContainerSubscriptions","_callbacks","prototype","setStores","stores","_this","_stores","_resetTokens","_resetStoreGroup","changed","changedStores","process","env","NODE_ENV","_tokens","map","store","addListener","push","setChanged","callCallbacks","forEach","fn","_storeGroup","reset","_resetCallbacks","_resetStores","token","remove","release","module","exports"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) 2014-present, Facebook, Inc. All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule FluxContainerSubscriptions\n * \n */\n\n'use strict';\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar FluxStoreGroup = require('./FluxStoreGroup');\n\nfunction shallowArrayEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n  if (a.length !== b.length) {\n    return false;\n  }\n  for (var i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nvar FluxContainerSubscriptions = (function () {\n  function FluxContainerSubscriptions() {\n    _classCallCheck(this, FluxContainerSubscriptions);\n\n    this._callbacks = [];\n  }\n\n  FluxContainerSubscriptions.prototype.setStores = function setStores(stores) {\n    var _this = this;\n\n    if (this._stores && shallowArrayEqual(this._stores, stores)) {\n      return;\n    }\n    this._stores = stores;\n    this._resetTokens();\n    this._resetStoreGroup();\n\n    var changed = false;\n    var changedStores = [];\n\n    if (process.env.NODE_ENV !== 'production') {\n      // Keep track of the stores that changed for debugging purposes only\n      this._tokens = stores.map(function (store) {\n        return store.addListener(function () {\n          changed = true;\n          changedStores.push(store);\n        });\n      });\n    } else {\n      (function () {\n        var setChanged = function () {\n          changed = true;\n        };\n        _this._tokens = stores.map(function (store) {\n          return store.addListener(setChanged);\n        });\n      })();\n    }\n\n    var callCallbacks = function () {\n      if (changed) {\n        _this._callbacks.forEach(function (fn) {\n          return fn();\n        });\n        changed = false;\n        if (process.env.NODE_ENV !== 'production') {\n          // Uncomment this to print the stores that changed.\n          // console.log(changedStores);\n          changedStores = [];\n        }\n      }\n    };\n    this._storeGroup = new FluxStoreGroup(stores, callCallbacks);\n  };\n\n  FluxContainerSubscriptions.prototype.addListener = function addListener(fn) {\n    this._callbacks.push(fn);\n  };\n\n  FluxContainerSubscriptions.prototype.reset = function reset() {\n    this._resetTokens();\n    this._resetStoreGroup();\n    this._resetCallbacks();\n    this._resetStores();\n  };\n\n  FluxContainerSubscriptions.prototype._resetTokens = function _resetTokens() {\n    if (this._tokens) {\n      this._tokens.forEach(function (token) {\n        return token.remove();\n      });\n      this._tokens = null;\n    }\n  };\n\n  FluxContainerSubscriptions.prototype._resetStoreGroup = function _resetStoreGroup() {\n    if (this._storeGroup) {\n      this._storeGroup.release();\n      this._storeGroup = null;\n    }\n  };\n\n  FluxContainerSubscriptions.prototype._resetStores = function _resetStores() {\n    this._stores = null;\n  };\n\n  FluxContainerSubscriptions.prototype._resetCallbacks = function _resetCallbacks() {\n    this._callbacks = [];\n  };\n\n  return FluxContainerSubscriptions;\n})();\n\nmodule.exports = FluxContainerSubscriptions;"]},"metadata":{},"sourceType":"script"}